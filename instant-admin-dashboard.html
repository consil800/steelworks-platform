<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instant í…œí”Œë¦¿ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ - SteelWorks Platform</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #0066cc 0%, #0052a3 50%, #003d7a 100%);
            color: #ffffff;
            min-height: 100vh;
        }

        .admin-dashboard {
            display: block;
            min-height: 100vh;
        }

        .admin-header {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem 2rem;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: #ffffff;
            font-size: 1.5rem;
            font-weight: 800;
        }

        .admin-nav {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ffffff;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-btn:hover,
        .nav-btn.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
        }

        .admin-content {
            padding: 2rem;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 2rem;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .data-grid {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .grid-header {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .grid-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #ffffff;
        }

        .btn {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .btn-danger:hover {
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4);
        }

        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: #e2e8f0;
            font-weight: 600;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: #2d3748;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.7);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 1);
        }

        .form-select option {
            background: #ffffff;
            color: #2d3748;
            padding: 0.5rem;
            font-weight: 500;
        }

        .form-select option:hover {
            background: #e2e8f0;
        }

        .form-input::placeholder, .form-textarea::placeholder {
            color: rgba(45, 55, 72, 0.6);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .employee-table {
            width: 100%;
            border-collapse: collapse;
        }

        .employee-table th,
        .employee-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .employee-table th {
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
            font-weight: 700;
        }

        .employee-table td {
            color: #e2e8f0;
        }

        .role-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .role-master {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .role-admin {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
        }

        .role-manager {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
            color: white;
        }

        .role-employee {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal[style*="block"] {
            display: flex !important;
        }

        .modal-content {
            background: linear-gradient(135deg, #0066cc, #0052a3);
            padding: 2rem;
            border-radius: 15px;
            max-width: 800px;
            width: 95%;
            color: white;
            max-height: 95vh;
            overflow-y: auto;
            min-height: 700px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h3 {
            margin: 0;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.8;
        }

        .close-btn:hover {
            opacity: 1;
        }

        .employee-card, .permission-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .employee-info h4, .permission-info h4 {
            margin: 0 0 0.5rem 0;
            color: #ffffff;
            font-size: 1.2rem;
        }

        .employee-info p, .permission-info p {
            margin: 0.25rem 0;
            color: #e2e8f0;
            font-size: 0.9rem;
        }

        .employee-actions, .permission-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            justify-content: center;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .modal-actions .btn {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            min-width: 120px;
        }

        /* ë©”ì¸ ê´€ë¦¬ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .management-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 70vh;
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 2rem;
        }

        .management-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 3rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .management-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            width: 100%;
            max-width: 800px;
        }

        .management-card {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }

        .management-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .management-card i {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            display: block;
        }

        .management-card h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .management-card p {
            font-size: 1rem;
            opacity: 0.9;
            line-height: 1.6;
        }

        .homepage-card {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }

        .homepage-management-card {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .employees-card {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        .permissions-card {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .status-indicator {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: rgba(0, 0, 0, 0.7);
            padding: 1rem;
            border-radius: 8px;
            color: white;
            font-size: 0.9rem;
        }

        .close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.8;
        }

        .close:hover {
            opacity: 1;
        }

        @media (max-width: 768px) {
            .admin-header {
                flex-direction: column;
                gap: 1rem;
            }

            .admin-nav {
                justify-content: center;
            }

            .form-row {
                flex-direction: column;
            }

            .admin-content {
                padding: 1rem;
            }

            .management-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .management-title {
                font-size: 2rem;
            }

            .management-card {
                min-height: 150px;
                padding: 1.5rem;
            }

            .management-card i {
                font-size: 3rem;
                margin-bottom: 1rem;
            }

            .management-card h3 {
                font-size: 1.25rem;
            }

            .management-card p {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="admin-dashboard">
        <!-- Header -->
        <header class="admin-header">
            <div class="admin-logo">
                <i class="fas fa-cogs"></i>
                <span id="companyTitle">Instant í…œí”Œë¦¿ - ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</span>
            </div>
            <div class="admin-nav">
            </div>
        </header>

        <!-- Content -->
        <main class="admin-content">
            <div class="management-container" style="display: flex;">
                <h1 class="management-title">Instant í…œí”Œë¦¿ ê´€ë¦¬</h1>
                
                <div class="management-grid">
                    <a href="../../1-homepage/templates/index.html" class="management-card homepage-card" target="_blank">
                        <i class="fas fa-home"></i>
                        <h3>í™ˆí˜ì´ì§€</h3>
                        <p>ì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ë¥¼ í™•ì¸í•˜ê³  ë³€ê²½ëœ ë‚´ìš©ì„ ë¯¸ë¦¬ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </a>
                    
                    <a href="../../1-homepage/management/instant-homepage-management.html" class="management-card homepage-management-card" id="homepageManagementLink">
                        <i class="fas fa-globe"></i>
                        <h3>í™ˆí˜ì´ì§€ ê´€ë¦¬</h3>
                        <p>ë©”ì¸í˜ì´ì§€ì™€ ìƒì„¸í˜ì´ì§€ì˜ ì½˜í…ì¸ ë¥¼ í¸ì§‘í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
                    </a>
                    
                    <button class="management-card employees-card" onclick="showEmployeeManagement()">
                        <i class="fas fa-users"></i>
                        <h3>ì§ì› ê´€ë¦¬</h3>
                        <p>ì§ì› ì •ë³´ë¥¼ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œí•˜ê³  ì—­í• ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
                    </button>
                    
                    <button class="management-card permissions-card" onclick="showPermissionManagement()">
                        <i class="fas fa-shield-alt"></i>
                        <h3>ê¶Œí•œ ì„¤ì •</h3>
                        <p>ì‚¬ìš©ìë³„ ì ‘ê·¼ ê¶Œí•œê³¼ ê¸°ëŠ¥ ê¶Œí•œì„ ì„¤ì •í•©ë‹ˆë‹¤.</p>
                    </button>
                </div>
            </div>
            <section class="content-section" id="employees" style="display: none;">
                <button class="btn btn-secondary" onclick="backToDashboard()" style="margin-bottom: 1rem;">
                    <i class="fas fa-arrow-left"></i> ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°
                </button>
                <h2 class="section-title">ì§ì› ê´€ë¦¬</h2>
                
                <div class="data-grid">
                    <div class="grid-header">
                        <h3 class="grid-title">ì§ì› ëª©ë¡</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn" onclick="console.log('âš™ï¸ ì„¤ì • ë²„íŠ¼ í´ë¦­ë¨'); window.openEmployeeSettingsModal(); return false;" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                <i class="fas fa-cog"></i> ì„¤ì •
                            </button>
                            <button class="btn" onclick="console.log('â• ì§ì› ì¶”ê°€ ë²„íŠ¼ í´ë¦­ë¨'); window.openEmployeeModal(); return false;">
                                <i class="fas fa-plus"></i> ì§ì› ì¶”ê°€
                            </button>
                        </div>
                    </div>
                    <div style="padding: 2rem;">
                        <div id="employeeList">
                            <!-- ì§ì› ëª©ë¡ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- ê¶Œí•œ ì„¤ì • ì„¹ì…˜ -->
            <section class="content-section" id="permissions" style="display: none;">
                <button class="btn btn-secondary" onclick="backToDashboard()" style="margin-bottom: 1rem;">
                    <i class="fas fa-arrow-left"></i> ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°
                </button>
                <h2 class="section-title">ê¶Œí•œ ì„¤ì •</h2>
                
                <div class="data-grid">
                    <div class="grid-header">
                        <h3 class="grid-title">ê¶Œí•œ ê´€ë¦¬</h3>
                        <button class="btn" onclick="openPermissionModal()">
                            <i class="fas fa-plus"></i> ê¶Œí•œ ì¶”ê°€
                        </button>
                    </div>
                    <div style="padding: 2rem;">
                        <div id="permissionList">
                            <!-- ê¶Œí•œ ëª©ë¡ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>

                <!-- ê¶Œí•œ ëª¨ë‹¬ -->
                <div id="permissionModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>ê¶Œí•œ ì„¤ì •</h3>
                            <button class="close" onclick="closePermissionModal()">&times;</button>
                        </div>
                        <form id="permissionForm">
                            <div class="form-group">
                                <label class="form-label">ê¶Œí•œëª…</label>
                                <input type="text" class="form-input" id="permissionName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì„¤ëª…</label>
                                <textarea class="form-textarea" id="permissionDescription"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì ‘ê·¼ ê¶Œí•œ</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" id="canRead"> ì½ê¸°</label>
                                    <label><input type="checkbox" id="canWrite"> ì“°ê¸°</label>
                                    <label><input type="checkbox" id="canDelete"> ì‚­ì œ</label>
                                    <label><input type="checkbox" id="canManage"> ê´€ë¦¬</label>
                                </div>
                            </div>
                            <div class="modal-actions">
                                <button type="button" class="btn btn-secondary" onclick="closePermissionModal()">ì·¨ì†Œ</button>
                                <button type="submit" class="btn btn-primary">ì €ì¥</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>
        </main>

        <!-- ì§ì› ëª¨ë‹¬ (ìµœìƒìœ„ ë ˆë²¨) -->
        <div id="employeeModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">ì§ì› ì •ë³´</h3>
                    <button class="close" onclick="window.closeEmployeeModal()">&times;</button>
                </div>
                <form id="employeeForm" onsubmit="event.preventDefault(); console.log('ğŸ“¤ í¼ ì œì¶œë¨'); window.saveEmployee(); return false;">
                    <!-- ì²« ë²ˆì§¸ í–‰: ì´ë¦„ê³¼ ì´ë©”ì¼ -->
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì´ë¦„</label>
                            <input type="text" class="form-input" id="employeeName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì´ë©”ì¼</label>
                            <input type="email" class="form-input" id="employeeEmail" required>
                        </div>
                    </div>
                    
                    <!-- ë‘ ë²ˆì§¸ í–‰: ê¶Œí•œê³¼ ì—°ë½ì²˜ -->
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ê¶Œí•œ</label>
                            <select class="form-select" id="employeeRole" required>
                                <option value="">ê¶Œí•œì„ ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="employee">ì§ì›</option>
                                <option value="manager">ê´€ë¦¬ì</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì—°ë½ì²˜</label>
                            <input type="tel" class="form-input" id="employeePhone">
                        </div>
                    </div>
                    
                    <!-- ì„¸ ë²ˆì§¸ í–‰: ì†Œì† ë¶€ì„œì™€ ì§ì±… -->
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì†Œì† ë¶€ì„œ</label>
                            <select class="form-select" id="employeeDepartment" required>
                                <option value="">ë¶€ì„œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì§ì±…</label>
                            <select class="form-select" id="employeePosition" required>
                                <option value="">ì§ì±…ì„ ì„ íƒí•˜ì„¸ìš”</option>
                                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                            </select>
                        </div>
                    </div>
                    
                    <!-- ë²„íŠ¼ ì˜ì—­ -->
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" onclick="window.closeEmployeeModal()">ì·¨ì†Œ</button>
                        <button type="submit" class="btn btn-primary">ì €ì¥</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ì§ì› ì„¤ì • ëª¨ë‹¬ -->
        <div id="employeeSettingsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>ì§ì› ê´€ë¦¬ ì„¤ì •</h3>
                    <button class="close" onclick="closeEmployeeSettingsModal()">&times;</button>
                </div>
                <div style="padding: 1rem;">
                    <!-- ë¶€ì„œ ê´€ë¦¬ -->
                    <div style="margin-bottom: 2rem;">
                        <h4 style="color: #e2e8f0; margin-bottom: 1rem;">ë¶€ì„œ ê´€ë¦¬</h4>
                        <div id="departmentsList" style="margin-bottom: 1rem;">
                            <!-- í˜„ì¬ ë¶€ì„œë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="newDepartmentInput" class="form-input" placeholder="ìƒˆ ë¶€ì„œëª… ì…ë ¥" style="flex: 1;">
                            <button class="btn" onclick="addDepartment()" style="background: linear-gradient(135deg, #10b981, #059669);">
                                <i class="fas fa-plus"></i> ì¶”ê°€
                            </button>
                        </div>
                    </div>
                    
                    <!-- ì§ì±… ê´€ë¦¬ -->
                    <div style="margin-bottom: 2rem;">
                        <h4 style="color: #e2e8f0; margin-bottom: 1rem;">ì§ì±… ê´€ë¦¬</h4>
                        <div id="positionsList" style="margin-bottom: 1rem;">
                            <!-- í˜„ì¬ ì§ì±…ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="newPositionInput" class="form-input" placeholder="ìƒˆ ì§ì±…ëª… ì…ë ¥" style="flex: 1;">
                            <button class="btn" onclick="addPosition()" style="background: linear-gradient(135deg, #10b981, #059669);">
                                <i class="fas fa-plus"></i> ì¶”ê°€
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeEmployeeSettingsModal()">ë‹«ê¸°</button>
                </div>
            </div>
        </div>

        <!-- ìƒíƒœ í‘œì‹œ -->
        <div id="statusIndicator" class="status-indicator">
            <div class="status-item">
                <span id="dataStatus">ğŸ’¾ ë°ì´í„°: ë¡œë”© ì¤‘...</span>
            </div>
        </div>
    </div>

    <script>
        // ì¸ì¦ ê´€ë¦¬ì (AuthManager) - Scoutì™€ ë™ì¼í•œ ê¸°ëŠ¥
        class AuthManager {
            static setCurrentUser(user) {
                localStorage.setItem('currentUser', JSON.stringify(user));
            }

            static getCurrentUser() {
                const user = localStorage.getItem('currentUser');
                return user ? JSON.parse(user) : null;
            }

            static logout() {
                localStorage.removeItem('currentUser');
                window.location.href = '../employee/employee-dashboard.html';
            }
        }

        // ì „ì—­ ë³€ìˆ˜
        let currentTemplate = 'instant';
        let currentEditingEmployee = null;
        let currentEditingPermission = null;

        // íšŒì‚¬ëª… ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateCompanyTitle(companyId) {
            console.log('ğŸ¢ Instant í…œí”Œë¦¿ íšŒì‚¬ëª… ì—…ë°ì´íŠ¸:', companyId);
            
            if (!companyId) {
                console.log('âŒ companyIdê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            const companies = JSON.parse(localStorage.getItem('platform_companies') || '[]');
            const company = companies.find(c => c.id === companyId);
            
            const companyNameMap = {
                'seokyoung-snt': 'ì„œê²½ S&T',
                'posco': 'í¬ìŠ¤ì½” ì² ê°•',
                'hyundai-steel': 'í˜„ëŒ€ì œì² ',
                'namkyung-steel': 'ë‚¨ê²½ìŠ¤í‹¸',
                'new-test-company': 'ìƒˆë¡œìš´í…ŒìŠ¤íŠ¸íšŒì‚¬',
                '': 'ëŒ€í•œì² ê°•' // Instant í…œí”Œë¦¿ ê¸°ë³¸ê°’
            };
            
            const companyName = company?.companyName || companyNameMap[companyId] || companyId;
            const titleElement = document.getElementById('companyTitle');
            
            console.log('ğŸ“‹ ì°¾ì€ íšŒì‚¬ ì •ë³´:', {
                companyId,
                company,
                companyName,
                titleElement: !!titleElement
            });
            
            if (titleElement) {
                const newTitle = `${companyName} - Instant í…œí”Œë¦¿ ê´€ë¦¬`;
                titleElement.textContent = newTitle;
                document.title = newTitle;
                console.log('âœ… íšŒì‚¬ëª… ì—…ë°ì´íŠ¸ ì™„ë£Œ:', newTitle);
                
                // í™ˆí˜ì´ì§€ ê´€ë¦¬ ë§í¬ë„ ì—…ë°ì´íŠ¸
                const homepageLink = document.getElementById('homepageManagementLink');
                if (homepageLink) {
                    homepageLink.href = `instant-homepage-management.html?company=${companyId}`;
                    console.log('ğŸ”— í™ˆí˜ì´ì§€ ê´€ë¦¬ ë§í¬ ì—…ë°ì´íŠ¸:', homepageLink.href);
                }
            } else {
                console.log('âŒ titleElementë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
            }
        }

        // ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateStatus() {
            const statusElement = document.getElementById('dataStatus');
            const data = localStorage.getItem(`template_instant_settings`);
            
            if (data) {
                const parsed = JSON.parse(data);
                const companyName = parsed.basic?.companyName || 'ë¯¸ì„¤ì •';
                statusElement.innerHTML = `ğŸ’¾ ë°ì´í„°: âœ… ì €ì¥ë¨ (${companyName})`;
            } else {
                statusElement.innerHTML = 'ğŸ’¾ ë°ì´í„°: âŒ ì—†ìŒ';
            }
        }
        
        // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ë“¤ (Scoutê³¼ ë™ì¼)
        function handleEditClick(e) {
            e.preventDefault();
            e.stopPropagation();
            const employeeId = this.getAttribute('data-employee-id');
            console.log('ğŸ“ ìˆ˜ì • ë²„íŠ¼ í´ë¦­ (í•¸ë“¤ëŸ¬):', employeeId);
            editEmployee(employeeId);
        }

        function handleDeleteClick(e) {
            e.preventDefault();
            e.stopPropagation();
            const employeeId = this.getAttribute('data-employee-id');
            console.log('ğŸ—‘ï¸ ì‚­ì œ ë²„íŠ¼ í´ë¦­ (í•¸ë“¤ëŸ¬):', employeeId);
            deleteEmployee(employeeId);
        }

        // ì „ì—­ í•¨ìˆ˜ ë“±ë¡ (Scoutê³¼ ë™ì¼)
        window.editEmployee = editEmployee;
        window.simpleEditEmployee = simpleEditEmployee;
        window.deleteEmployee = deleteEmployee;
        window.openEmployeeModal = openEmployeeModal;
        window.closeEmployeeModal = closeEmployeeModal;
        window.saveEmployee = saveEmployee;
        window.backToDashboard = backToDashboard;
        window.showEmployeeManagement = showEmployeeManagement;
        window.showPermissionManagement = showPermissionManagement;
        window.handleEditClick = handleEditClick;
        window.handleDeleteClick = handleDeleteClick;
        window.openEmployeeSettingsModal = openEmployeeSettingsModal;
        window.closeEmployeeSettingsModal = closeEmployeeSettingsModal;
        window.addDepartment = addDepartment;
        window.addPosition = addPosition;
        window.removeDepartment = removeDepartment;
        window.removePosition = removePosition;

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™” (Scoutê³¼ ë™ì¼í•˜ì§€ë§Œ Instant ìš©ìœ¼ë¡œ ìˆ˜ì •)
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ Instant í…œí”Œë¦¿ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì‹œì‘');
            
            const masterAccess = JSON.parse(localStorage.getItem('master_company_access') || '{}');
            const urlParams = new URLSearchParams(window.location.search);
            const companyId = urlParams.get('company');
            
            console.log('ğŸ” ì´ˆê¸°í™” ì •ë³´:', {
                masterAccess,
                companyId,
                currentUrl: window.location.href
            });
            
            let user = AuthManager.getCurrentUser();
            
            if (masterAccess.role === 'master' && companyId === masterAccess.companyId) {
                console.log('ğŸ”‘ ë§ˆìŠ¤í„° ê¶Œí•œìœ¼ë¡œ Instant í…œí”Œë¦¿ ì ‘ê·¼:', companyId);
                const masterUser = JSON.parse(localStorage.getItem('steelplatform_currentUser') || localStorage.getItem('currentUser') || '{}');
                if (masterUser.role === 'master') {
                    AuthManager.setCurrentUser(masterUser);
                    user = masterUser;
                    console.log('âœ… ë§ˆìŠ¤í„° ì‚¬ìš©ì ê¶Œí•œ ì„¤ì • ì™„ë£Œ');
                }
                
                updateCompanyTitle(companyId);
            }
            
            if (!user) {
                const testMasterUser = {
                    id: 'master-001',
                    name: 'ì‹œìŠ¤í…œ ê´€ë¦¬ì',
                    email: 'master@daehaniron.co.kr',
                    role: 'master',
                    department: 'ê´€ë¦¬ë¶€',
                    position: 'ì‹œìŠ¤í…œ ê´€ë¦¬ì'
                };
                AuthManager.setCurrentUser(testMasterUser);
                user = testMasterUser;
                console.log('âœ… í…ŒìŠ¤íŠ¸ìš© ë§ˆìŠ¤í„° ì‚¬ìš©ì ìë™ ë¡œê·¸ì¸');
            }
            
            if (!hasAdminPermission(user)) {
                alert('ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.');
                console.log('âŒ ê¶Œí•œ ì—†ìŒ:', user);
                return;
            }
            
            console.log('âœ… í˜„ì¬ ì‚¬ìš©ì:', user);
            
            if (companyId) {
                updateCompanyTitle(companyId);
            } else {
                const titleElement = document.getElementById('companyTitle');
                if (titleElement) {
                    titleElement.textContent = 'Instant í…œí”Œë¦¿ - ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ';
                    document.title = 'Instant í…œí”Œë¦¿ - ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ';
                }
            }
            
            loadData();
            initializeTestEmployees();
            setupEventListeners();
            updateStatus();
            updateEmployeeFormOptions();
            
            setTimeout(() => {
                console.log('ğŸ”„ ì§ì› ëª©ë¡ ê°•ì œ ë Œë”ë§ ì‹œì‘');
                renderEmployeeList();
                
                setTimeout(() => {
                    const employeeList = document.getElementById('employeeList');
                    console.log('ğŸ“‹ ì§ì› ëª©ë¡ ì»¨í…Œì´ë„ˆ:', employeeList);
                    console.log('ğŸ”„ ì§ì› ëª©ë¡ HTML:', employeeList?.innerHTML?.substring(0, 200) + '...');
                    
                    const editButtons = document.querySelectorAll('.edit-employee-btn');
                    console.log('ğŸ“ ìˆ˜ì • ë²„íŠ¼ ê°œìˆ˜:', editButtons.length);
                    editButtons.forEach((btn, index) => {
                        console.log(`ìˆ˜ì • ë²„íŠ¼ ${index}:`, btn);
                    });
                    
                    const modal = document.getElementById('employeeModal');
                    console.log('ğŸ­ ëª¨ë‹¬ ìš”ì†Œ:', modal);
                    
                    console.log('ğŸ”§ simpleEditEmployee í•¨ìˆ˜:', window.simpleEditEmployee);
                    console.log('â• openEmployeeModal í•¨ìˆ˜:', window.openEmployeeModal);
                }, 200);
            }, 500);
            
            document.addEventListener('click', function(e) {
                if (e.target.closest('.management-card, .btn, .nav-btn')) {
                    setTimeout(updateStatus, 100);
                }
            });
            
            document.addEventListener('submit', function(e) {
                setTimeout(updateStatus, 100);
            });
        });

        function hasAdminPermission(user) {
            const adminRoles = ['master', 'company_admin', 'company_manager'];
            return adminRoles.includes(user.role);
        }

        function canManageEmployees(user) {
            const managerRoles = ['master', 'company_admin', 'company_manager'];
            return managerRoles.includes(user.role);
        }

        function isSystemUser(role) {
            return ['master', 'company_admin'].includes(role);
        }

        function updateRoleOptions(currentUser, employeeId = null) {
            const roleSelect = document.getElementById('employeeRole');
            
            let options = '<option value="">ê¶Œí•œì„ ì„ íƒí•˜ì„¸ìš”</option>';
            options += '<option value="employee">ì§ì›</option>';
            options += '<option value="manager">ê´€ë¦¬ì</option>';
            
            roleSelect.innerHTML = options;
        }

        // Scoutì˜ ì§ì› ê´€ë¦¬ í•¨ìˆ˜ë“¤ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë˜ Instantìš© í‚¤ ì‚¬ìš©
        function renderEmployeeList() {
            console.log('ğŸ”„ Instant í…œí”Œë¦¿ ì§ì› ëª©ë¡ ë Œë”ë§ ì‹œì‘');
            
            const urlParams = new URLSearchParams(window.location.search);
            const companyId = urlParams.get('company');
            console.log('ğŸ¢ í˜„ì¬ íšŒì‚¬ ID:', companyId);
            
            let employees = [];
            
            if (companyId) {
                const companyKey = `instant_company_${companyId}_employees`;
                const companyEmployees = JSON.parse(localStorage.getItem(companyKey) || '[]');
                console.log(`ğŸ“ ${companyKey}ì—ì„œ ${companyEmployees.length}ëª… ë°œê²¬`);
                
                if (companyEmployees.length > 0) {
                    employees = companyEmployees;
                } else {
                    const allEmployees = JSON.parse(localStorage.getItem('instant_employees') || '[]');
                    employees = allEmployees.filter(emp => emp.companyId === companyId);
                    console.log(`ğŸ“ í†µí•© ëª©ë¡ì—ì„œ ${employees.length}ëª… í•„í„°ë§`);
                }
            } else {
                employees = JSON.parse(localStorage.getItem('instant_employees') || '[]');
                console.log(`ğŸ“ ëª¨ë“  ì§ì›: ${employees.length}ëª…`);
            }
            
            const employeeList = document.getElementById('employeeList');
            const currentUser = AuthManager.getCurrentUser();
            
            console.log('ğŸ‘¥ í‘œì‹œí•  ì§ì› ìˆ˜:', employees.length);
            console.log('ğŸ‘¤ í˜„ì¬ ì‚¬ìš©ì:', currentUser);
            
            if (employees.length === 0) {
                employeeList.innerHTML = '<p style="text-align: center; color: #9ca3af;">ë“±ë¡ëœ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            const htmlContent = employees.map(emp => {
                const isSystemUser = ['master', 'company_admin'].includes(emp.role);
                const canEdit = canManageEmployees(currentUser) && (!isSystemUser || currentUser.role === 'master');
                const canDelete = canManageEmployees(currentUser) && !isSystemUser;
                
                console.log(`ğŸ‘¤ ${emp.name}: canEdit=${canEdit}, canDelete=${canDelete}, isSystemUser=${isSystemUser}`);
                
                return `
                    <div class="employee-card" data-employee-id="${emp.id}">
                        <div class="employee-info">
                            <h4>${emp.name} ${isSystemUser ? '<i class="fas fa-shield-alt" style="color: #f59e0b; margin-left: 0.5rem;" title="ì‹œìŠ¤í…œ ì‚¬ìš©ì"></i>' : ''}</h4>
                            <p>${emp.email}</p>
                            <p>${emp.department || 'ë¯¸ì„¤ì •'} | ${emp.position || 'ë¯¸ì„¤ì •'}</p>
                            <span class="role-badge role-${emp.role}">${getRoleText(emp.role)}</span>
                        </div>
                        <div class="employee-actions">
                            ${canEdit ? `
                                <button type="button" class="btn btn-small edit-employee-btn" data-employee-id="${emp.id}" onclick="console.log('ğŸ“ ìˆ˜ì • ë²„íŠ¼ í´ë¦­: ${emp.id}'); try { window.simpleEditEmployee('${emp.id}'); } catch(e) { console.error('ìˆ˜ì • ì˜¤ë¥˜:', e); alert('ìˆ˜ì • ì˜¤ë¥˜: ' + e.message); } return false;">
                                    <i class="fas fa-edit"></i> ìˆ˜ì •
                                </button>
                            ` : ''}
                            ${canDelete ? `
                                <button type="button" class="btn btn-small btn-danger delete-employee-btn" data-employee-id="${emp.id}" onclick="console.log('ğŸ—‘ï¸ ì‚­ì œ ë²„íŠ¼ í´ë¦­: ${emp.id}'); window.deleteEmployee('${emp.id}'); return false;">
                                    <i class="fas fa-trash"></i> ì‚­ì œ
                                </button>
                            ` : ''}
                            ${!canEdit && !canDelete ? `
                                <span style="color: #6b7280; font-size: 0.8rem;">ê¶Œí•œ ì—†ìŒ</span>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            employeeList.innerHTML = htmlContent;
            
            setTimeout(() => {
                const editButtons = document.querySelectorAll('.edit-employee-btn');
                console.log('ğŸ“ ìˆ˜ì • ë²„íŠ¼ ì°¾ìŒ:', editButtons.length);
                
                editButtons.forEach((btn, index) => {
                    console.log(`ìˆ˜ì • ë²„íŠ¼ ${index}:`, btn.getAttribute('data-employee-id'));
                    btn.removeEventListener('click', handleEditClick);
                    btn.addEventListener('click', handleEditClick);
                });
                
                const deleteButtons = document.querySelectorAll('.delete-employee-btn');
                console.log('ğŸ—‘ï¸ ì‚­ì œ ë²„íŠ¼ ì°¾ìŒ:', deleteButtons.length);
                
                deleteButtons.forEach((btn, index) => {
                    console.log(`ì‚­ì œ ë²„íŠ¼ ${index}:`, btn.getAttribute('data-employee-id'));
                    btn.removeEventListener('click', handleDeleteClick);
                    btn.addEventListener('click', handleDeleteClick);
                });
                
                console.log('âœ… Instant í…œí”Œë¦¿ ì§ì› ëª©ë¡ ë Œë”ë§ ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì™„ë£Œ');
            }, 100);
        }

        function initializeTestEmployees() {
            console.log('ğŸ’¡ Instant í…œí”Œë¦¿ ì§ì› ë°ì´í„°ëŠ” master-dashboard.htmlì—ì„œ ê´€ë¦¬ë©ë‹ˆë‹¤.');
            renderEmployeeList();
            return;
        }

        function getTemplateName(templateId) {
            const names = {
                'instant': 'ëŒ€í•œì² ê°•',
                'scout': 'í•œêµ­ì² ê°•',
                'visible': 'ë¹„ì „ìŠ¤í‹¸',
                'dewi': 'ë™ì–‘ì² ê°•',
                'nice-restaurant': 'í•œì¼ì² ê°•',
                'iportfolio': 'í¬í•­ì² ê°•',
                'blogy': 'í•œêµ­ì‚°ì—…',
                'gp': 'ê¸€ë¡œë²Œì² ê°•',
                'upconstruction': 'ëŒ€í•œì¤‘ê³µì—…'
            };
            return names[templateId] || templateId;
        }

        function setupEventListeners() {
            document.querySelectorAll('.nav-btn[data-section]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    switchSection(section);
                });
            });

            document.getElementById('employeeForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveEmployee();
            });

            document.getElementById('permissionForm').addEventListener('submit', function(e) {
                e.preventDefault();
                savePermission();
            });
        }

        function switchSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-btn[data-section]').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            const targetBtn = document.querySelector(`[data-section="${sectionId}"]`);
            if (targetBtn) {
                targetBtn.classList.add('active');
            }
        }

        function loadData() {
            loadEmployees();
            loadPermissions();
        }

        function loadEmployees() {
            renderEmployeeList();
        }

        function getRoleText(role) {
            const roleTexts = {
                'employee': 'ì§ì›',
                'manager': 'ë§¤ë‹ˆì €',
                'company_admin': 'íšŒì‚¬ ê´€ë¦¬ì',
                'master': 'ë§ˆìŠ¤í„°'
            };
            return roleTexts[role] || role;
        }

        function openEmployeeModal(employeeId = null) {
            console.log('ğŸ”µ Instant í…œí”Œë¦¿ openEmployeeModal í˜¸ì¶œë¨. employeeId:', employeeId);
            
            try {
                const currentUser = AuthManager.getCurrentUser();
                console.log('ğŸ‘¤ í˜„ì¬ ì‚¬ìš©ì:', currentUser);
                
                if (!canManageEmployees(currentUser)) {
                    alert('ì§ì› ê´€ë¦¬ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
                    console.log('âŒ ê¶Œí•œ ì²´í¬ ì‹¤íŒ¨');
                    return;
                }
                
                console.log('âœ… ê¶Œí•œ ì²´í¬ í†µê³¼');
                
                currentEditingEmployee = employeeId;
                const modal = document.getElementById('employeeModal');
                const form = document.getElementById('employeeForm');
                
                console.log('ğŸ¯ ëª¨ë‹¬ ìš”ì†Œ:', modal);
                console.log('ğŸ“ í¼ ìš”ì†Œ:', form);
                
                if (!modal) {
                    console.error('âŒ ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
                    alert('ëª¨ë‹¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                if (!form) {
                    console.error('âŒ í¼ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
                    alert('í¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                modal.style.display = 'flex';
                modal.style.alignItems = 'center';
                modal.style.justifyContent = 'center';
                console.log('ğŸ“– ëª¨ë‹¬ í‘œì‹œë¨');
                
                form.reset();
                console.log('ğŸ”„ í¼ ì´ˆê¸°í™” ì™„ë£Œ');
                
                try {
                    updateRoleOptions(currentUser, employeeId);
                    updateEmployeeFormOptions();
                    console.log('âš™ï¸ ê¶Œí•œ ì˜µì…˜ ì„¤ì • ì™„ë£Œ');
                } catch (error) {
                    console.error('âŒ ê¶Œí•œ ì˜µì…˜ ì„¤ì • ì‹¤íŒ¨:', error);
                }
                
                if (employeeId) {
                    console.log('ğŸ“ ì§ì› ìˆ˜ì • ëª¨ë“œ');
                    
                    const urlParams = new URLSearchParams(window.location.search);
                    const companyId = urlParams.get('company');
                    
                    let employee = null;
                    
                    if (companyId) {
                        const companyKey = `instant_company_${companyId}_employees`;
                        const companyEmployees = JSON.parse(localStorage.getItem(companyKey) || '[]');
                        employee = companyEmployees.find(emp => emp.id === employeeId);
                    }
                    
                    if (!employee) {
                        const allEmployees = JSON.parse(localStorage.getItem('instant_employees') || '[]');
                        employee = allEmployees.find(emp => emp.id === employeeId);
                    }
                    
                    console.log('ğŸ‘¤ ìˆ˜ì •í•  ì§ì›:', employee);
                    
                    if (employee) {
                        const nameEl = document.getElementById('employeeName');
                        const emailEl = document.getElementById('employeeEmail');
                        const deptEl = document.getElementById('employeeDepartment');
                        const posEl = document.getElementById('employeePosition');
                        const phoneEl = document.getElementById('employeePhone');
                        const roleEl = document.getElementById('employeeRole');
                        
                        if (nameEl) nameEl.value = employee.name || '';
                        if (emailEl) emailEl.value = employee.email || '';
                        if (deptEl) deptEl.value = employee.department || '';
                        if (posEl) posEl.value = employee.position || '';
                        if (phoneEl) phoneEl.value = employee.phone || '';
                        if (roleEl) roleEl.value = employee.role || '';
                        
                        if (roleEl && isSystemUser(employee.role) && currentUser.role !== 'master') {
                            roleEl.disabled = true;
                        } else if (roleEl) {
                            roleEl.disabled = false;
                        }
                        
                        console.log('âœ… ì§ì› ì •ë³´ ë¡œë“œ ì™„ë£Œ');
                    }
                } else {
                    console.log('â• ì§ì› ì¶”ê°€ ëª¨ë“œ');
                    const roleEl = document.getElementById('employeeRole');
                    if (roleEl) roleEl.disabled = false;
                }
                
                console.log('ğŸ‰ ëª¨ë‹¬ ì—´ê¸° ì™„ë£Œ');
                
            } catch (error) {
                console.error('âŒ openEmployeeModal ì˜¤ë¥˜:', error);
                alert('ëª¨ë‹¬ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        function closeEmployeeModal() {
            console.log('âŒ ì§ì› ëª¨ë‹¬ ë‹«ê¸°');
            const modal = document.getElementById('employeeModal');
            modal.style.display = 'none';
            currentEditingEmployee = null;
            
            const form = document.getElementById('employeeForm');
            if (form) {
                form.reset();
            }
            
            const roleSelect = document.getElementById('employeeRole');
            if (roleSelect) {
                roleSelect.disabled = false;
            }
        }

        function saveEmployee() {
            const currentUser = AuthManager.getCurrentUser();
            
            if (!canManageEmployees(currentUser)) {
                alert('ì§ì› ê´€ë¦¬ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const name = document.getElementById('employeeName').value.trim();
            const email = document.getElementById('employeeEmail').value.trim();
            const role = document.getElementById('employeeRole').value;
            const department = document.getElementById('employeeDepartment').value.trim();
            const position = document.getElementById('employeePosition').value.trim();
            const phone = document.getElementById('employeePhone').value.trim();
            
            if (!name || !email || !role) {
                alert('ì´ë¦„, ì´ë©”ì¼, ê¶Œí•œì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
                return;
            }
            
            const urlParams = new URLSearchParams(window.location.search);
            const companyId = urlParams.get('company');
            
            let companyEmployees = [];
            if (companyId) {
                const companyKey = `instant_company_${companyId}_employees`;
                companyEmployees = JSON.parse(localStorage.getItem(companyKey) || '[]');
            }
            const allEmployees = JSON.parse(localStorage.getItem('instant_employees') || '[]');
            
            if (currentEditingEmployee) {
                const companyIndex = companyEmployees.findIndex(emp => emp.id === currentEditingEmployee);
                const allIndex = allEmployees.findIndex(emp => emp.id === currentEditingEmployee);
                
                if (companyIndex !== -1) {
                    const originalEmployee = companyEmployees[companyIndex];
                    
                    if (isSystemUser(originalEmployee.role) && currentUser.role !== 'master') {
                        alert('ë§ˆìŠ¤í„°ë§Œ ì‹œìŠ¤í…œ ì‚¬ìš©ìì˜ ê¶Œí•œì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    if (isSystemUser(role) && currentUser.role !== 'master') {
                        alert('ë§ˆìŠ¤í„°ë§Œ ì‹œìŠ¤í…œ ê¶Œí•œ(ë§ˆìŠ¤í„°, íšŒì‚¬ëŒ€í‘œ)ì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    const updatedEmployee = {
                        ...originalEmployee,
                        name,
                        email,
                        role,
                        department,
                        position,
                        phone,
                        updatedAt: new Date().toISOString()
                    };
                    
                    companyEmployees[companyIndex] = updatedEmployee;
                    
                    if (allIndex !== -1) {
                        allEmployees[allIndex] = updatedEmployee;
                    }
                }
            } else {
                if (isSystemUser(role) && currentUser.role !== 'master') {
                    alert('ë§ˆìŠ¤í„°ë§Œ ì‹œìŠ¤í…œ ê¶Œí•œ(ë§ˆìŠ¤í„°, íšŒì‚¬ëŒ€í‘œ)ì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                    return;
                }
                
                const newEmployee = {
                    id: Date.now().toString(),
                    name,
                    email,
                    role,
                    department,
                    position,
                    phone,
                    companyId: companyId,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                if (companyId) {
                    companyEmployees.push(newEmployee);
                }
                
                allEmployees.push(newEmployee);
            }
            
            if (companyId) {
                const companyKey = `instant_company_${companyId}_employees`;
                localStorage.setItem(companyKey, JSON.stringify(companyEmployees));
            }
            localStorage.setItem('instant_employees', JSON.stringify(allEmployees));
            
            renderEmployeeList();
            
            if (typeof window.syncEmployeeCount === 'function') {
                window.syncEmployeeCount(companyId);
                console.log('ğŸ”„ ë§ˆìŠ¤í„° ëŒ€ì‹œë³´ë“œì— ì§ì› ìˆ˜ ë™ê¸°í™”');
            }
            
            closeEmployeeModal();
            
            console.log('ğŸ’¾ Instant í…œí”Œë¦¿ ì§ì› ë°ì´í„° ì €ì¥ ì™„ë£Œ:', companyEmployees.find(emp => emp.id === (currentEditingEmployee || companyEmployees[companyEmployees.length - 1]?.id)));
        }

        function editEmployee(employeeId) {
            console.log('ğŸ”§ğŸ”§ğŸ”§ Instant í…œí”Œë¦¿ editEmployee í•¨ìˆ˜ í˜¸ì¶œë¨! employeeId:', employeeId);
            
            try {
                console.log('âš¡ ì¦‰ì‹œ ëª¨ë‹¬ ì—´ê¸° ì‹œë„');
                openEmployeeModal(employeeId);
                
            } catch (error) {
                console.error('âŒ editEmployee ì˜¤ë¥˜:', error);
                alert('ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
            }
        }

        function simpleEditEmployee(employeeId) {
            console.log('ğŸ”¥ Instant í…œí”Œë¦¿ simpleEditEmployee í˜¸ì¶œë¨:', employeeId);
            openEmployeeModal(employeeId);
        }

        function deleteEmployee(employeeId) {
            const currentUser = AuthManager.getCurrentUser();
            
            const urlParams = new URLSearchParams(window.location.search);
            const companyId = urlParams.get('company');
            
            let companyEmployees = [];
            if (companyId) {
                const companyKey = `instant_company_${companyId}_employees`;
                companyEmployees = JSON.parse(localStorage.getItem(companyKey) || '[]');
            }
            const allEmployees = JSON.parse(localStorage.getItem('instant_employees') || '[]');
            
            const employee = companyEmployees.find(emp => emp.id === employeeId) || 
                           allEmployees.find(emp => emp.id === employeeId);
            
            if (!employee) {
                return;
            }
            
            if (!canManageEmployees(currentUser)) {
                alert('ì§ì› ì‚­ì œ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (isSystemUser(employee.role)) {
                alert('ì‹œìŠ¤í…œ ì‚¬ìš©ì(ë§ˆìŠ¤í„°, íšŒì‚¬ëŒ€í‘œ)ëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (!confirm(`ì •ë§ë¡œ ${employee.name} ì§ì›ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            if (companyId) {
                const filteredCompanyEmployees = companyEmployees.filter(emp => emp.id !== employeeId);
                const companyKey = `instant_company_${companyId}_employees`;
                localStorage.setItem(companyKey, JSON.stringify(filteredCompanyEmployees));
            }
            
            const filteredAllEmployees = allEmployees.filter(emp => emp.id !== employeeId);
            localStorage.setItem('instant_employees', JSON.stringify(filteredAllEmployees));
            
            renderEmployeeList();
            
            if (typeof window.syncEmployeeCount === 'function') {
                window.syncEmployeeCount(companyId);
                console.log('ğŸ”„ ë§ˆìŠ¤í„° ëŒ€ì‹œë³´ë“œì— ì§ì› ìˆ˜ ë™ê¸°í™”');
            }
            
            alert('ì§ì›ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ê¶Œí•œ ê´€ë¦¬ í•¨ìˆ˜ë“¤ (Scoutê³¼ ë™ì¼í•˜ì§€ë§Œ Instantìš© í‚¤ ì‚¬ìš©)
        function loadPermissions() {
            const permissions = JSON.parse(localStorage.getItem('instant_permissions') || '[]');
            const permissionList = document.getElementById('permissionList');
            
            if (permissions.length === 0) {
                permissionList.innerHTML = '<p style="text-align: center; color: #9ca3af;">ì„¤ì •ëœ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            permissionList.innerHTML = permissions.map(perm => `
                <div class="permission-card">
                    <div class="permission-info">
                        <h4>${perm.name}</h4>
                        <p>${perm.description || 'ì„¤ëª… ì—†ìŒ'}</p>
                        <div class="permission-badges">
                            ${perm.canRead ? '<span class="badge">ì½ê¸°</span>' : ''}
                            ${perm.canWrite ? '<span class="badge">ì“°ê¸°</span>' : ''}
                            ${perm.canDelete ? '<span class="badge">ì‚­ì œ</span>' : ''}
                            ${perm.canManage ? '<span class="badge">ê´€ë¦¬</span>' : ''}
                        </div>
                    </div>
                    <div class="permission-actions">
                        <button class="btn btn-small" onclick="editPermission('${perm.id}')">
                            <i class="fas fa-edit"></i> ìˆ˜ì •
                        </button>
                        <button class="btn btn-small btn-danger" onclick="deletePermission('${perm.id}')">
                            <i class="fas fa-trash"></i> ì‚­ì œ
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function openPermissionModal(permissionId = null) {
            currentEditingPermission = permissionId;
            const modal = document.getElementById('permissionModal');
            const form = document.getElementById('permissionForm');
            
            form.reset();
            
            if (permissionId) {
                const permissions = JSON.parse(localStorage.getItem('instant_permissions') || '[]');
                const permission = permissions.find(perm => perm.id === permissionId);
                
                if (permission) {
                    document.getElementById('permissionName').value = permission.name;
                    document.getElementById('permissionDescription').value = permission.description || '';
                    document.getElementById('canRead').checked = permission.canRead || false;
                    document.getElementById('canWrite').checked = permission.canWrite || false;
                    document.getElementById('canDelete').checked = permission.canDelete || false;
                    document.getElementById('canManage').checked = permission.canManage || false;
                }
            }
            
            modal.style.display = 'block';
        }

        function closePermissionModal() {
            document.getElementById('permissionModal').style.display = 'none';
            currentEditingPermission = null;
        }

        function savePermission() {
            const name = document.getElementById('permissionName').value.trim();
            const description = document.getElementById('permissionDescription').value.trim();
            const canRead = document.getElementById('canRead').checked;
            const canWrite = document.getElementById('canWrite').checked;
            const canDelete = document.getElementById('canDelete').checked;
            const canManage = document.getElementById('canManage').checked;
            
            if (!name) {
                alert('ê¶Œí•œëª…ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
                return;
            }
            
            const permissions = JSON.parse(localStorage.getItem('instant_permissions') || '[]');
            
            if (currentEditingPermission) {
                const index = permissions.findIndex(perm => perm.id === currentEditingPermission);
                if (index !== -1) {
                    permissions[index] = {
                        ...permissions[index],
                        name,
                        description,
                        canRead,
                        canWrite,
                        canDelete,
                        canManage,
                        updatedAt: new Date().toISOString()
                    };
                }
            } else {
                const newPermission = {
                    id: Date.now().toString(),
                    name,
                    description,
                    canRead,
                    canWrite,
                    canDelete,
                    canManage,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                permissions.push(newPermission);
            }
            
            localStorage.setItem('instant_permissions', JSON.stringify(permissions));
            loadPermissions();
            closePermissionModal();
            
            alert(currentEditingPermission ? 'ê¶Œí•œì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ê¶Œí•œì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function editPermission(permissionId) {
            openPermissionModal(permissionId);
        }

        function deletePermission(permissionId) {
            if (!confirm('ì •ë§ë¡œ ì´ ê¶Œí•œì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }
            
            const permissions = JSON.parse(localStorage.getItem('instant_permissions') || '[]');
            const filteredPermissions = permissions.filter(perm => perm.id !== permissionId);
            
            localStorage.setItem('instant_permissions', JSON.stringify(filteredPermissions));
            loadPermissions();
            
            alert('ê¶Œí•œì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function showEmployeeManagement() {
            const user = AuthManager.getCurrentUser();
            if (!user || !canManageEmployees(user)) {
                alert('ì§ì› ê´€ë¦¬ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. ë§ˆìŠ¤í„°, íšŒì‚¬ëŒ€í‘œ, ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }

            document.querySelector('.management-container').style.display = 'none';
            document.getElementById('employees').style.display = 'block';
        }

        function showPermissionManagement() {
            window.location.href = 'instant-company-admin.html';
        }

        function backToDashboard() {
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            document.querySelector('.management-container').style.display = 'flex';
        }

        // ì§ì› ì„¤ì • ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤ (Scoutê³¼ ë™ì¼í•˜ì§€ë§Œ Instantìš© í‚¤ ì‚¬ìš©)
        function openEmployeeSettingsModal() {
            console.log('âš™ï¸ Instant í…œí”Œë¦¿ ì§ì› ì„¤ì • ëª¨ë‹¬ ì—´ê¸°');
            const modal = document.getElementById('employeeSettingsModal');
            if (modal) {
                modal.style.display = 'flex';
                loadDepartmentsAndPositions();
            } else {
                console.error('âŒ ì„¤ì • ëª¨ë‹¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
            }
        }

        function closeEmployeeSettingsModal() {
            const modal = document.getElementById('employeeSettingsModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        function loadDepartmentsAndPositions() {
            const departments = getDepartments();
            const positions = getPositions();
            
            renderDepartmentsList(departments);
            renderPositionsList(positions);
        }

        function getDepartments() {
            const saved = localStorage.getItem('instant_employee_departments');
            return saved ? JSON.parse(saved) : ['ì˜ì—…ë¶€', 'ê´€ë¦¬ë¶€', 'ë¬¼ë¥˜ë¶€'];
        }

        function getPositions() {
            const saved = localStorage.getItem('instant_employee_positions');
            return saved ? JSON.parse(saved) : ['ì´ì‚¬', 'ë¶€ì¥', 'ì°¨ì¥', 'ê³¼ì¥', 'ëŒ€ë¦¬', 'ê³„ì¥'];
        }

        function saveDepartments(departments) {
            localStorage.setItem('instant_employee_departments', JSON.stringify(departments));
            updateEmployeeFormOptions();
        }

        function savePositions(positions) {
            localStorage.setItem('instant_employee_positions', JSON.stringify(positions));
            updateEmployeeFormOptions();
        }

        function renderDepartmentsList(departments) {
            const container = document.getElementById('departmentsList');
            if (!container) return;
            
            container.innerHTML = departments.map((dept, index) => `
                <div style="display: flex; align-items: center; justify-content: space-between; background: rgba(255,255,255,0.1); padding: 0.75rem; border-radius: 8px; margin-bottom: 0.5rem;">
                    <span style="color: #e2e8f0;">${dept}</span>
                    <button class="btn btn-danger btn-small" onclick="removeDepartment('${dept}')" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `).join('');
        }

        function renderPositionsList(positions) {
            const container = document.getElementById('positionsList');
            if (!container) return;
            
            container.innerHTML = positions.map((pos, index) => `
                <div style="display: flex; align-items: center; justify-content: space-between; background: rgba(255,255,255,0.1); padding: 0.75rem; border-radius: 8px; margin-bottom: 0.5rem;">
                    <span style="color: #e2e8f0;">${pos}</span>
                    <button class="btn btn-danger btn-small" onclick="removePosition('${pos}')" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `).join('');
        }

        function addDepartment() {
            const input = document.getElementById('newDepartmentInput');
            const newDept = input.value.trim();
            
            if (!newDept) {
                alert('ë¶€ì„œëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const departments = getDepartments();
            if (departments.includes(newDept)) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë¶€ì„œì…ë‹ˆë‹¤.');
                return;
            }
            
            departments.push(newDept);
            saveDepartments(departments);
            renderDepartmentsList(departments);
            input.value = '';
            
            alert('ìƒˆ ë¶€ì„œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function addPosition() {
            const input = document.getElementById('newPositionInput');
            const newPos = input.value.trim();
            
            if (!newPos) {
                alert('ì§ì±…ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const positions = getPositions();
            if (positions.includes(newPos)) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì§ì±…ì…ë‹ˆë‹¤.');
                return;
            }
            
            positions.push(newPos);
            savePositions(positions);
            renderPositionsList(positions);
            input.value = '';
            
            alert('ìƒˆ ì§ì±…ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function removeDepartment(deptToRemove) {
            const employees = JSON.parse(localStorage.getItem('instant_employees') || '[]');
            const employeesUsingDept = employees.filter(emp => emp.department === deptToRemove);
            
            if (employeesUsingDept.length > 0) {
                alert(`'${deptToRemove}' ë¶€ì„œë¥¼ ì‚¬ìš©í•˜ëŠ” ì§ì›ì´ ${employeesUsingDept.length}ëª… ìˆìŠµë‹ˆë‹¤. ë¨¼ì € í•´ë‹¹ ì§ì›ë“¤ì˜ ë¶€ì„œë¥¼ ë³€ê²½í•´ì£¼ì„¸ìš”.`);
                return;
            }
            
            if (!confirm(`'${deptToRemove}' ë¶€ì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            const departments = getDepartments().filter(dept => dept !== deptToRemove);
            saveDepartments(departments);
            renderDepartmentsList(departments);
            
            alert('ë¶€ì„œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function removePosition(posToRemove) {
            const employees = JSON.parse(localStorage.getItem('instant_employees') || '[]');
            const employeesUsingPos = employees.filter(emp => emp.position === posToRemove);
            
            if (employeesUsingPos.length > 0) {
                alert(`'${posToRemove}' ì§ì±…ì„ ì‚¬ìš©í•˜ëŠ” ì§ì›ì´ ${employeesUsingPos.length}ëª… ìˆìŠµë‹ˆë‹¤. ë¨¼ì € í•´ë‹¹ ì§ì›ë“¤ì˜ ì§ì±…ì„ ë³€ê²½í•´ì£¼ì„¸ìš”.`);
                return;
            }
            
            if (!confirm(`'${posToRemove}' ì§ì±…ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            const positions = getPositions().filter(pos => pos !== posToRemove);
            savePositions(positions);
            renderPositionsList(positions);
            
            alert('ì§ì±…ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function updateEmployeeFormOptions() {
            const departments = getDepartments();
            const positions = getPositions();
            
            const deptSelect = document.getElementById('employeeDepartment');
            const posSelect = document.getElementById('employeePosition');
            
            if (deptSelect) {
                const currentValue = deptSelect.value;
                let deptOptions = '<option value="">ë¶€ì„œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>';
                departments.forEach(dept => {
                    deptOptions += `<option value="${dept}">${dept}</option>`;
                });
                deptSelect.innerHTML = deptOptions;
                deptSelect.value = currentValue;
            }
            
            if (posSelect) {
                const currentValue = posSelect.value;
                let posOptions = '<option value="">ì§ì±…ì„ ì„ íƒí•˜ì„¸ìš”</option>';
                positions.forEach(pos => {
                    posOptions += `<option value="${pos}">${pos}</option>`;
                });
                posSelect.innerHTML = posOptions;
                posSelect.value = currentValue;
            }
        }

        function goToMasterDashboard() {
            const currentUser = AuthManager.getCurrentUser();
            
            if (currentUser.role === 'master') {
                window.location.href = 'master-dashboard.html';
            } else {
                alert('ë§ˆìŠ¤í„° ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.');
            }
        }
        
        function logout() {
            if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                AuthManager.logout();
                window.location.href = '../../1-homepage/templates/index.html';
            }
        }

    </script>
    <script src="../../shared-assets/js/platform.js"></script>
</body>
</html>